-- MySQL Script generated by MySQL Workbench
-- mar. 19 mars 2019 10:24:30 CET
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema mydb
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table `mydb`.`CLUB`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CLUB` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `NOM` VARCHAR(200) NOT NULL,
  `HORAIRES` VARCHAR(1000) NOT NULL,
  `TEL` CHAR(10) NOT NULL,
  `EMAIL` VARCHAR(400) NOT NULL,
  `ADRESSE` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ENTRAINEMENT`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ENTRAINEMENT` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `HEURE_DEBUT` DATETIME NOT NULL,
  `HEURE_FIN` DATETIME NOT NULL,
  `NIVEAU` ENUM('D', 'I', 'A') NOT NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`AVATAR`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`AVATAR` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `CONTENT` BLOB NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ABONNE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ABONNE` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `PRENOM` VARCHAR(100) NOT NULL,
  `NOM` VARCHAR(100) NOT NULL,
  `PSEUDO` VARCHAR(100) NULL,
  `EMAIL` VARCHAR(200) NOT NULL,
  `MDP` CHAR(16) NOT NULL,
  `REDUCTION` TINYINT(1) NOT NULL DEFAULT 0,
  `DESCRIPTION` VARCHAR(2000) NULL,
  `NIVEAU` ENUM('D', 'I', 'A') NOT NULL,
  `CLUB_ID` INT UNSIGNED NOT NULL,
  `ENTRAINEMENT_ID` INT UNSIGNED NOT NULL,
  `AVATAR_ID` INT UNSIGNED NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_ABONNE_CLUB1_idx` (`CLUB_ID` ASC),
  INDEX `fk_ABONNE_ENTRAINEMENT1_idx` (`ENTRAINEMENT_ID` ASC),
  INDEX `fk_ABONNE_AVATAR1_idx` (`AVATAR_ID` ASC),
  CONSTRAINT `fk_ABONNE_CLUB1`
    FOREIGN KEY (`CLUB_ID`)
    REFERENCES `mydb`.`CLUB` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ABONNE_ENTRAINEMENT1`
    FOREIGN KEY (`ENTRAINEMENT_ID`)
    REFERENCES `mydb`.`ENTRAINEMENT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ABONNE_AVATAR1`
    FOREIGN KEY (`AVATAR_ID`)
    REFERENCES `mydb`.`AVATAR` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`TERRAIN`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`TERRAIN` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `COUVERT` TINYINT(1) NOT NULL DEFAULT 0,
  `TYPE` ENUM('TERRE BATTUE', 'GAZON', 'SYNTHETIQUE') NOT NULL,
  `CLUB_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_TERRAIN_CLUB1_idx` (`CLUB_ID` ASC),
  CONSTRAINT `fk_TERRAIN_CLUB1`
    FOREIGN KEY (`CLUB_ID`)
    REFERENCES `mydb`.`CLUB` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`MATCH`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`MATCH` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `HEURE_DEBUT` DATETIME NOT NULL,
  `HEURE_FIN` DATETIME NOT NULL,
  `COMPETITION` TINYINT(1) NOT NULL DEFAULT 0,
  `ABONNE_ID_GAGNANT` INT UNSIGNED NOT NULL,
  `ABONNE_ID_PERDANT` INT UNSIGNED NOT NULL,
  `TERRAIN_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `fk_MATCH_ABONNE1_idx` (`ABONNE_ID_GAGNANT` ASC),
  INDEX `fk_MATCH_ABONNE2_idx` (`ABONNE_ID_PERDANT` ASC),
  INDEX `fk_MATCH_TERRAIN1_idx` (`TERRAIN_ID` ASC),
  CONSTRAINT `fk_MATCH_ABONNE1`
    FOREIGN KEY (`ABONNE_ID_GAGNANT`)
    REFERENCES `mydb`.`ABONNE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_MATCH_ABONNE2`
    FOREIGN KEY (`ABONNE_ID_PERDANT`)
    REFERENCES `mydb`.`ABONNE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_MATCH_TERRAIN1`
    FOREIGN KEY (`TERRAIN_ID`)
    REFERENCES `mydb`.`TERRAIN` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ENTRAINEUR`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ENTRAINEUR` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `PRENOM` VARCHAR(100) NOT NULL,
  `NOM` VARCHAR(100) NOT NULL,
  `DESCRIPTION` VARCHAR(2000) NULL,
  `AVATAR` VARCHAR(45) NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`CLUB_has_ABONNE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CLUB_has_ABONNE` (
  `CLUB_ID` INT UNSIGNED NOT NULL,
  `ABONNE_ID` INT UNSIGNED NULL,
  PRIMARY KEY (`CLUB_ID`, `ABONNE_ID`),
  INDEX `fk_CLUB_has_ABONNE_ABONNE1_idx` (`ABONNE_ID` ASC),
  INDEX `fk_CLUB_has_ABONNE_CLUB_idx` (`CLUB_ID` ASC),
  CONSTRAINT `fk_CLUB_has_ABONNE_CLUB`
    FOREIGN KEY (`CLUB_ID`)
    REFERENCES `mydb`.`CLUB` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CLUB_has_ABONNE_ABONNE1`
    FOREIGN KEY (`ABONNE_ID`)
    REFERENCES `mydb`.`ABONNE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`CLUB_has_ABONNE1`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`CLUB_has_ABONNE1` (
  `CLUB_ID` INT UNSIGNED NOT NULL,
  `ABONNE_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`CLUB_ID`, `ABONNE_ID`),
  INDEX `fk_CLUB_has_ABONNE1_ABONNE1_idx` (`ABONNE_ID` ASC),
  INDEX `fk_CLUB_has_ABONNE1_CLUB1_idx` (`CLUB_ID` ASC),
  CONSTRAINT `fk_CLUB_has_ABONNE1_CLUB1`
    FOREIGN KEY (`CLUB_ID`)
    REFERENCES `mydb`.`CLUB` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CLUB_has_ABONNE1_ABONNE1`
    FOREIGN KEY (`ABONNE_ID`)
    REFERENCES `mydb`.`ABONNE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`GAGNE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`GAGNE` (
  `ABONNE_ID` INT UNSIGNED NOT NULL,
  `MATCH_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ABONNE_ID`, `MATCH_ID`),
  INDEX `fk_ABONNE_has_MATCH_MATCH1_idx` (`MATCH_ID` ASC),
  INDEX `fk_ABONNE_has_MATCH_ABONNE1_idx` (`ABONNE_ID` ASC),
  CONSTRAINT `fk_ABONNE_has_MATCH_ABONNE1`
    FOREIGN KEY (`ABONNE_ID`)
    REFERENCES `mydb`.`ABONNE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ABONNE_has_MATCH_MATCH1`
    FOREIGN KEY (`MATCH_ID`)
    REFERENCES `mydb`.`MATCH` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ABONNE_has_MATCH`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ABONNE_has_MATCH` (
  `ABONNE_ID` INT UNSIGNED NOT NULL,
  `MATCH_ID` INT UNSIGNED NOT NULL,
  `MATCH_ABONNE_ID_GAGNANT` INT UNSIGNED NOT NULL,
  `MATCH_ABONNE_ID_PERDANT` INT UNSIGNED NOT NULL,
  `MATCH_TERRAIN_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ABONNE_ID`, `MATCH_ID`, `MATCH_ABONNE_ID_GAGNANT`, `MATCH_ABONNE_ID_PERDANT`, `MATCH_TERRAIN_ID`),
  INDEX `fk_ABONNE_has_MATCH_MATCH2_idx` (`MATCH_ID` ASC, `MATCH_ABONNE_ID_GAGNANT` ASC, `MATCH_ABONNE_ID_PERDANT` ASC, `MATCH_TERRAIN_ID` ASC),
  INDEX `fk_ABONNE_has_MATCH_ABONNE2_idx` (`ABONNE_ID` ASC),
  CONSTRAINT `fk_ABONNE_has_MATCH_ABONNE2`
    FOREIGN KEY (`ABONNE_ID`)
    REFERENCES `mydb`.`ABONNE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ABONNE_has_MATCH_MATCH2`
    FOREIGN KEY (`MATCH_ID` , `MATCH_ABONNE_ID_GAGNANT` , `MATCH_ABONNE_ID_PERDANT` , `MATCH_TERRAIN_ID`)
    REFERENCES `mydb`.`MATCH` (`ID` , `ABONNE_ID_GAGNANT` , `ABONNE_ID_PERDANT` , `TERRAIN_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`MATCH_has_ABONNE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`MATCH_has_ABONNE` (
  `ABONNE_ID` INT UNSIGNED NOT NULL,
  `MATCH_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ABONNE_ID`, `MATCH_ID`),
  INDEX `fk_ABONNE_has_MATCH1_MATCH1_idx` (`MATCH_ID` ASC),
  INDEX `fk_ABONNE_has_MATCH1_ABONNE1_idx` (`ABONNE_ID` ASC),
  CONSTRAINT `fk_ABONNE_has_MATCH1_ABONNE1`
    FOREIGN KEY (`ABONNE_ID`)
    REFERENCES `mydb`.`ABONNE` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ABONNE_has_MATCH1_MATCH1`
    FOREIGN KEY (`MATCH_ID`)
    REFERENCES `mydb`.`MATCH` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ENTRAINEMENT_has_TERRAIN`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ENTRAINEMENT_has_TERRAIN` (
  `ENTRAINEMENT_ID` INT UNSIGNED NOT NULL,
  `TERRAIN_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ENTRAINEMENT_ID`, `TERRAIN_ID`),
  INDEX `fk_ENTRAINEMENT_has_TERRAIN_TERRAIN1_idx` (`TERRAIN_ID` ASC),
  INDEX `fk_ENTRAINEMENT_has_TERRAIN_ENTRAINEMENT1_idx` (`ENTRAINEMENT_ID` ASC),
  CONSTRAINT `fk_ENTRAINEMENT_has_TERRAIN_ENTRAINEMENT1`
    FOREIGN KEY (`ENTRAINEMENT_ID`)
    REFERENCES `mydb`.`ENTRAINEMENT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ENTRAINEMENT_has_TERRAIN_TERRAIN1`
    FOREIGN KEY (`TERRAIN_ID`)
    REFERENCES `mydb`.`TERRAIN` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ENTRAINEUR_has_ENTRAINEMENT`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ENTRAINEUR_has_ENTRAINEMENT` (
  `ENTRAINEUR_ID` INT UNSIGNED NOT NULL,
  `ENTRAINEMENT_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ENTRAINEUR_ID`, `ENTRAINEMENT_ID`),
  INDEX `fk_ENTRAINEUR_has_ENTRAINEMENT_ENTRAINEMENT1_idx` (`ENTRAINEMENT_ID` ASC),
  INDEX `fk_ENTRAINEUR_has_ENTRAINEMENT_ENTRAINEUR1_idx` (`ENTRAINEUR_ID` ASC),
  CONSTRAINT `fk_ENTRAINEUR_has_ENTRAINEMENT_ENTRAINEUR1`
    FOREIGN KEY (`ENTRAINEUR_ID`)
    REFERENCES `mydb`.`ENTRAINEUR` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ENTRAINEUR_has_ENTRAINEMENT_ENTRAINEMENT1`
    FOREIGN KEY (`ENTRAINEMENT_ID`)
    REFERENCES `mydb`.`ENTRAINEMENT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`ENTRAINEMENT_has_ENTRAINEUR`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`ENTRAINEMENT_has_ENTRAINEUR` (
  `ENTRAINEMENT_ID` INT UNSIGNED NOT NULL,
  `ENTRAINEUR_ID` INT UNSIGNED NOT NULL,
  PRIMARY KEY (`ENTRAINEMENT_ID`, `ENTRAINEUR_ID`),
  INDEX `fk_ENTRAINEMENT_has_ENTRAINEUR_ENTRAINEUR1_idx` (`ENTRAINEUR_ID` ASC),
  INDEX `fk_ENTRAINEMENT_has_ENTRAINEUR_ENTRAINEMENT1_idx` (`ENTRAINEMENT_ID` ASC),
  CONSTRAINT `fk_ENTRAINEMENT_has_ENTRAINEUR_ENTRAINEMENT1`
    FOREIGN KEY (`ENTRAINEMENT_ID`)
    REFERENCES `mydb`.`ENTRAINEMENT` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_ENTRAINEMENT_has_ENTRAINEUR_ENTRAINEUR1`
    FOREIGN KEY (`ENTRAINEUR_ID`)
    REFERENCES `mydb`.`ENTRAINEUR` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`AVATAR`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`AVATAR` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `CONTENT` BLOB NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `mydb`.`IMAGE`
-- -----------------------------------------------------
CREATE TABLE IF NOT EXISTS `mydb`.`IMAGE` (
  `ID` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `CONTENT` BLOB NULL,
  PRIMARY KEY (`ID`))
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
